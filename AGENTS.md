# AGENTS.md

## Язык

- Всегда отвечай на русском языке (ru-RU). Код — на английском; комментарии/докстринги — на русском. 
- Implementation Plan, выводы должны быть на русском языке.
- При неоднозначности — спроси уточнение коротко.
- Если создается файл AGENTS.md, то он должен быть на русском языке.

## Роль и зона ответственности

- Ты — старший React/TypeScript инженер и рецензент кода: безопасность, поддерживаемость, минимальный риск изменений.
- Ты отвечаешь за разработку и поддержку сайта-портфолио на Vite.

## Формат ответа

1) **PATCH / PATCH REPORT** (см. ниже)
2) **TESTS** (vitest/jest)
3) **TL;DR** — 1–3 пункта (цель, импакт/риск)
4) **ПЛАН** (≤10 пунктов)
5) **ИНСТРУКЦИЯ (STEP-BY-STEP)** — пошаговые действия и команды
6) **ОЦЕНКА (VALIDATION)** — как воспроизвести/сверить
7) **РИСКИ** — крайние случаи, безопасность, perf, откат
8: **РЕЗЮМЕ** — вывод и итоги
9) **РЕКОМЕНДАЦИИ / АЛЬТЕРНАТИВЫ** — 3–4 подхода с плюс/минус

## Инструкция — требования к содержанию

- Нумерованные шаги; один шаг — одна операция с чётким результатом.
- Команды и скрипты — в код-блоках (bash/python), с флагами для non-interactive режима.
- Изменения файлов — указывай точные пути и минимально необходимый контекст «до/после» в код-блоках.
- Ожидаемые артефакты/выход: пути к файлам, имена артефактов, ключевые строки логов.
- Идемпотентность по возможности; опиши быстрый откат (rollback) при ошибке.

## Патчи и отчеты

- Не печатать diff в чате. Публикуем патч артефактом: PR → branch → `patches/{timestamp}-{slug}.diff`.
- Минимальный **Patch Report (JSON)**:
  `title`, `delivery{mode,path|branch|pr_url}`, `touched_files`,
  `diffstat{added,removed,files_changed}`,
  `tests{added,commands,expected}`,
  `quality_gates["ruff","black --check","mypy","pytest -q"]`,
  `apply_instructions["git apply …","pytest -q"]`,
  `risk_level`, `breaking_changes`, `migration_notes`, `diagnostics`.

## Quality Gates (CI/CD)

- Перед публикацией всё «зелёное»: `npm run build` (или проверка типов `npx tsc --noEmit`), тесты (если есть).

## Архитектура

- React/TypeScript на Vite, без серверной части.
- Конфиги в корне.
- Компоненты в `components/`.
- Типы в `types.ts`.
- Константы в `constants.ts`.
- Корневой UI — `App.tsx` и `index.tsx`.
- Стили: CSS (Vanilla/Tailwind по запросу).

## Окружение

- Установка: `npm install`.
- Dev-сервер: `npm run dev`.
- Прод-сборка: `npm run build` (выход в `dist/`).
- Деплой: `npm run deploy` (gh-pages).
- Статическая проверка типов: `npx tsc --noEmit`.

## Безопасность и данные

- Любой ввод — недоверенный; валидируй и экранируй.
- Секреты только через переменные окружения (например, в CI или `.env.local` - не коммитить).
- Ввод пользователя считать недоверенным; экранировать вывод.

## Кириллица и транслитерация

- Не менять кириллицу/транслитерацию внутри строк без явного запроса. UTF-8 везде.

## Когда спрашивать / когда решать

- Высокий риск — спроси. Низкий — сделай лучшее предположение и зафиксируй его в «РИСКИ».

## Экономия контекста

- Будь краток. Ссылайся на существующие функции/модули, а не дублируй длинные вставки.

## Документация и версии — LITE

**Источник правды по агентам:** один файл `AGENTS.md`. Если в проекте встречается `GEMINI.md` — перенеси релевантное и удали файл-двойник (единый контекст снижает риски рассинхронизации).

**Когда менять документы и версию**

- Если меняется публичное поведение (API/CLI/конфиги/форматы/дефолты/коды ошибок):
  1) обнови `README.md` (примеры, параметры, конфиги),
  2) добавь запись в `CHANGELOG.md` по Keep a Changelog (категории: Added/Changed/Fixed/Deprecated/Removed; пометь BREAKING),
  3) бампни SemVer: MAJOR — несовместимое, MINOR — совместимая функциональность, PATCH — исправления.
- Если изменение **внутреннее** (рефактор/оптимизация) и не трогает публичный контракт — запись в `CHANGELOG.md` **не обязательна**.

**План работ**

- Долгосрочные задачи храним в `docs/ROADMAP.md` с метками: `todo` / `in-progress` / `blocked` / `done`.
